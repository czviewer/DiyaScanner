<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Minimal QR Scanner Test</title>
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; text-align: center; }
  #qr-reader { width: 300px; margin: auto; }
  #result { margin-top: 20px; font-weight: bold; color: #333; }
</style>
</head>
<body>
  <h1>Minimal QR Scanner Test</h1>
  <div id="qr-reader"></div>
  <div id="result">Scan a QR code...</div>

  <script>
    const qrCodeReader = new Html5Qrcode("qr-reader");
    let isScanning = false;

    async function startScanner() {
      if (isScanning) return;
      try {
        const cameras = await Html5Qrcode.getCameras();
        if (cameras && cameras.length) {
          const cameraId = cameras[0].id;
          await qrCodeReader.start(
            cameraId,
            { fps: 10, qrbox: 250 },
            qrCodeSuccessCallback,
            qrCodeErrorCallback
          );
          isScanning = true;
        } else {
          document.getElementById("result").textContent = "No cameras found.";
        }
      } catch (e) {
        document.getElementById("result").textContent = "Error starting scanner: " + e;
      }
    }

    function qrCodeSuccessCallback(decodedText, decodedResult) {
      document.getElementById("result").textContent = "Scanned text:\n" + decodedText;
      // Optionally stop scanning after one successful scan:
      qrCodeReader.stop();
      isScanning = false;
    }

    function qrCodeErrorCallback(errorMessage) {
      // Uncomment to see scan errors in console:
      // console.warn("QR scan error:", errorMessage);
    }

    startScanner();
  </script>
</body>
</html>
